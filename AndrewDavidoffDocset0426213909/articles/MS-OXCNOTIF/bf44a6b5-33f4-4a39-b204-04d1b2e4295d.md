<html dir="LTR" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:tool="http://www.microsoft.com/tooltip">
    <head>
        <meta http-equiv="Content-Type" content="text/html; CHARSET=utf-8"></meta>
        <meta name="save" content="history"></meta>
        <title>2.2.1.4.1.2 NotificationData Structure</title>
        <xml>
            <mshelp:toctitle title="2.2.1.4.1.2 NotificationData Structure"></mshelp:toctitle>
            <mshelp:rltitle title="[MS-OXCNOTIF]: NotificationData Structure"></mshelp:rltitle>
            <mshelp:keyword index="A" term="bf44a6b5-33f4-4a39-b204-04d1b2e4295d"></mshelp:keyword>
            <mshelp:attr name="DCSext.ContentType" value="open specification"></mshelp:attr>
            <mshelp:attr name="AssetID" value="bf44a6b5-33f4-4a39-b204-04d1b2e4295d"></mshelp:attr>
            <mshelp:attr name="TopicType" value="kbRef"></mshelp:attr>
            <mshelp:attr name="DCSext.Title" value="[MS-OXCNOTIF]: NotificationData Structure" />
        </xml>
    </head>
    <body>
        <div id="header">
            <h1 class="heading">2.2.1.4.1.2 NotificationData Structure</h1>
        </div>
        <div id="mainSection">
            <div id="mainBody">
                <div id="allHistory" class="saveHistory"></div>
                <div id="sectionSection0" class="section" name="collapseableSection">
                    

<p>The <b>NotificationData</b> structure specifies details
about the notification. The contents of this structure are as follows.</p>

<p> </p>

<table>
 <tr>
  <th><p><br>0</p></th>
  <th><p><br>1</p></th>
  <th><p><br>2</p></th>
  <th><p><br>3</p></th>
  <th><p><br>4</p></th>
  <th><p><br>5</p></th>
  <th><p><br>6</p></th>
  <th><p><br>7</p></th>
  <th><p><br>8</p></th>
  <th><p><br>9</p></th>
  <th><p>1<br>0</p></th>
  <th><p><br>1</p></th>
  <th><p><br>2</p></th>
  <th><p><br>3</p></th>
  <th><p><br>4</p></th>
  <th><p><br>5</p></th>
  <th><p><br>6</p></th>
  <th><p><br>7</p></th>
  <th><p><br>8</p></th>
  <th><p><br>9</p></th>
  <th><p>2<br>0</p></th>
  <th><p><br>1</p></th>
  <th><p><br>2</p></th>
  <th><p><br>3</p></th>
  <th><p><br>4</p></th>
  <th><p><br>5</p></th>
  <th><p><br>6</p></th>
  <th><p><br>7</p></th>
  <th><p><br>8</p></th>
  <th><p><br>9</p></th>
  <th><p>3<br>0</p></th>
  <th><p><br>1</p></th>
 </tr>
 <tr>
  <td colspan="16">
  <p>NotificationFlags</p>
  </td>
  <td colspan="16">
  <p>TableEventType</p>
  </td>
 </tr>
 <tr>
  <td colspan="32">
  <p>TableRowFolderID</p>
  </td>
 </tr>
 <tr>
  <td colspan="32">
  <p>...</p>
  </td>
 </tr>
 <tr>
  <td colspan="32">
  <p>TableRowMessageID</p>
  </td>
 </tr>
 <tr>
  <td colspan="32">
  <p>...</p>
  </td>
 </tr>
 <tr>
  <td colspan="32">
  <p>TableRowInstance</p>
  </td>
 </tr>
 <tr>
  <td colspan="32">
  <p>InsertAfterTableRowFolderID</p>
  </td>
 </tr>
 <tr>
  <td colspan="32">
  <p>...</p>
  </td>
 </tr>
 <tr>
  <td colspan="32">
  <p>InsertAfterTableRowID</p>
  </td>
 </tr>
 <tr>
  <td colspan="32">
  <p>...</p>
  </td>
 </tr>
 <tr>
  <td colspan="32">
  <p>InsertAfterTableRowInstance</p>
  </td>
 </tr>
 <tr>
  <td colspan="16">
  <p>TableRowDataSize</p>
  </td>
  <td colspan="16">
  <p>TableRowData
  (variable)</p>
  </td>
 </tr>
 <tr>
  <td colspan="32">
  <p>...</p>
  </td>
 </tr>
 <tr>
  <td colspan="32">
  <p>FolderId</p>
  </td>
 </tr>
 <tr>
  <td colspan="32">
  <p>...</p>
  </td>
 </tr>
 <tr>
  <td colspan="32">
  <p>MessageId</p>
  </td>
 </tr>
 <tr>
  <td colspan="32">
  <p>...</p>
  </td>
 </tr>
 <tr>
  <td colspan="32">
  <p>ParentFolderId</p>
  </td>
 </tr>
 <tr>
  <td colspan="32">
  <p>...</p>
  </td>
 </tr>
 <tr>
  <td colspan="32">
  <p>OldFolderId</p>
  </td>
 </tr>
 <tr>
  <td colspan="32">
  <p>...</p>
  </td>
 </tr>
 <tr>
  <td colspan="32">
  <p>OldMessageId</p>
  </td>
 </tr>
 <tr>
  <td colspan="32">
  <p>...</p>
  </td>
 </tr>
 <tr>
  <td colspan="32">
  <p>OldParentFolderId</p>
  </td>
 </tr>
 <tr>
  <td colspan="32">
  <p>...</p>
  </td>
 </tr>
 <tr>
  <td colspan="16">
  <p>TagCount</p>
  </td>
  <td colspan="16">
  <p>Tags
  (variable)</p>
  </td>
 </tr>
 <tr>
  <td colspan="32">
  <p>...</p>
  </td>
 </tr>
 <tr>
  <td colspan="32">
  <p>TotalMessageCount</p>
  </td>
 </tr>
 <tr>
  <td colspan="32">
  <p>UnreadMessageCount</p>
  </td>
 </tr>
 <tr>
  <td colspan="32">
  <p>MessageFlags</p>
  </td>
 </tr>
 <tr>
  <td colspan="8">
  <p>UnicodeFlag</p>
  </td>
  <td colspan="24">
  <p>MessageClass
  (variable)</p>
  </td>
 </tr>
 <tr>
  <td colspan="32">
  <p>...</p>
  </td>
 </tr>
</table>

<p> </p>

<p><b>NotificationFlags (2 bytes):</b> A combination of
an enumeration and flags that describe the type of the notification and the
availability of the notification data fields.</p>

<dl>
<dd>
<p>The least significant 12 bits of the <b>NotificationFlags</b>
field contain the <b>NotificationType</b> enumeration, which defines the type
of the notification. The possible values for this enumeration are listed in the
following table.</p>
</dd>
<dd>
<table>
 <thead>
  <tr>
   <th>
   <p><span>Bit</span></p>
   </th>
   <th>
   <p><span>Meaning</span></p>
   </th>
  </tr>
 </thead>
 <tr>
  <td>
  <p><span>0x0002</span></p>
  </td>
  <td>
  <p><span>The notification is for a <b>NewMail</b> event.</span></p>
  </td>
 </tr>
 <tr>
  <td>
  <p><span>0x0004</span></p>
  </td>
  <td>
  <p><span>The notification is for an <b>ObjectCreated</b> event.</span></p>
  </td>
 </tr>
 <tr>
  <td>
  <p><span>0x0008</span></p>
  </td>
  <td>
  <p><span>The notification is for an <b>ObjectDeleted</b> event.</span></p>
  </td>
 </tr>
 <tr>
  <td>
  <p><span>0x0010</span></p>
  </td>
  <td>
  <p><span>The notification is for an <b>ObjectModified</b> event.</span></p>
  </td>
 </tr>
 <tr>
  <td>
  <p><span>0x0020</span></p>
  </td>
  <td>
  <p><span>The notification is for an <b>ObjectMoved</b> event.</span></p>
  </td>
 </tr>
 <tr>
  <td>
  <p><span>0x0040</span></p>
  </td>
  <td>
  <p><span>The notification is for an <b>ObjectCopied</b> event.</span></p>
  </td>
 </tr>
 <tr>
  <td>
  <p><span>0x0080</span></p>
  </td>
  <td>
  <p><span>The notification is for a <b>SearchCompleted</b> event.</span></p>
  </td>
 </tr>
 <tr>
  <td>
  <p><span>0x0100</span></p>
  </td>
  <td>
  <p><span>The notification is for a <b>TableModified</b> event.</span></p>
  </td>
 </tr>
 <tr>
  <td>
  <p><span>0x0400</span></p>
  </td>
  <td>
  <p><span>This value is reserved. It is not used by the server and <b>MUST</b>
  be ignored by the client.</span></p>
  </td>
 </tr>
</table>
</dd>
<dd>
<p>The most significant four bits of the <b>NotificationFlags</b>
field are flags that specify the availability of the notification data fields.</p>
</dd>
<dd>
<table>
 <thead>
  <tr>
   <th>
   <p><span>Bit</span></p>
   </th>
   <th>
   <p><span>Flag</span></p>
   </th>
   <th>
   <p><span>Meaning</span></p>
   </th>
  </tr>
 </thead>
 <tr>
  <td>
  <p><span>0x1000</span></p>
  </td>
  <td>
  <p><span>T</span></p>
  </td>
  <td>
  <p><span>The notification contains information about a change in the total
  number of messages in a folder triggering the event. If this bit is set, the <b>NotificationType</b>
  value MUST be 0x0010.</span></p>
  </td>
 </tr>
 <tr>
  <td>
  <p><span>0x2000</span></p>
  </td>
  <td>
  <p><span>U</span></p>
  </td>
  <td>
  <p><span>The notification contains information about a change in the number of
  unread messages in a folder triggering the event. If this bit is set, the <b>NotificationType</b>
  value MUST be 0x0010.</span></p>
  </td>
 </tr>
 <tr>
  <td>
  <p><span>0x4000</span></p>
  </td>
  <td>
  <p><span>S</span></p>
  </td>
  <td>
  <p><span>The notification is caused by an event in a <a href="04fcfcd9-a11c-47cd-aa0c-c10a4085d0c8.htm#gt_9ab569d0-496f-4ffb-a1c7-af848e3be035">search folder</a>. If this
  bit is set, bit 0x8000 MUST be set.</span></p>
  </td>
 </tr>
 <tr>
  <td>
  <p><span>0x8000</span></p>
  </td>
  <td>
  <p><span>M</span></p>
  </td>
  <td>
  <p><span>The notification is caused by an event on a message.</span></p>
  </td>
 </tr>
</table>
</dd>
<dd>
<p> </p>
</dd></dl>









<p><b>TableEventType (2 bytes):</b> A subtype of the
notification for a <b>TableModified</b> event. This field is available only if
the <b>NotificationType</b> value in the <b>NotificationFlags</b> field is
0x0100.</p>

<dl>
<dd>
<p>The following table lists the values that are
available for event types. For more details, see section <a href="feaccb32-c2ff-4859-94b0-f1dff18f4853.htm">2.2.1.1.1</a>.</p>
</dd>
<dd>
<table>
 <thead>
  <tr>
   <th>
   <p><span>Value</span></p>
   </th>
   <th>
   <p><span>Meaning</span></p>
   </th>
  </tr>
 </thead>
 <tr>
  <td>
  <p><span>0x0001</span></p>
  </td>
  <td>
  <p><span>The notification is for <b>TableChanged</b> events.</span></p>
  </td>
 </tr>
 <tr>
  <td>
  <p><span>0x0003</span></p>
  </td>
  <td>
  <p><span>The notification is for <b>TableRowAdded</b> events.</span></p>
  </td>
 </tr>
 <tr>
  <td>
  <p><span>0x0004</span></p>
  </td>
  <td>
  <p><span>The notification is for <b>TableRowDeleted</b> events.</span></p>
  </td>
 </tr>
 <tr>
  <td>
  <p><span>0x0005</span></p>
  </td>
  <td>
  <p><span>The notification is for <b>TableRowModified</b> events.</span></p>
  </td>
 </tr>
 <tr>
  <td>
  <p><span>0x0007</span></p>
  </td>
  <td>
  <p><span>The notification is for <b>TableRestrictionChanged</b> events. </span></p>
  </td>
 </tr>
</table>
</dd>
<dd>
<p> </p>
</dd></dl>





<p><b>TableRowFolderID (8 bytes):</b> The value of the <b>Folder
ID</b> structure, as specified in <mshelp:link keywords="1afa0cd9-b1a0-4520-b623-bf15030af5d8" tabindex="0">[MS-OXCDATA]</mshelp:link>
section <mshelp:link keywords="1c934e18-441b-4c47-9de0-eb34ffea47e3" tabindex="0">2.2.1.1</mshelp:link>,
of the item triggering the notification. This field is available only if the <b>TableEventType</b>
field is available and is 0x0003, 0x0004, or 0x0005.</p>

<p><b>TableRowMessageID (8 bytes):</b> The value of the <b>Message
ID</b> structure, as specified in [MS-OXCDATA] section <mshelp:link keywords="f1004d6b-b314-41a8-83cb-c64c3dbeebc4" tabindex="0">2.2.1.2</mshelp:link>,
of the item triggering the notification. This field is available only if bit
0x8000 is set in the <b>NotificationFlags</b> field and if the <b>TableEventType</b>
field is available and is 0x0003, 0x0004, or 0x0005.</p>

<p><b>TableRowInstance (4 bytes):</b> An identifier of
the instance of the previous row in the table. This field is available only if
bit 0x8000 is set in the <b>NotificationFlags</b> field and if the <b>TableEventType</b>
field is available and is 0x0003, 0x0004, or 0x0005.</p>

<p><b>InsertAfterTableRowFolderID (8 bytes):</b> The old
value of the <b>Folder ID</b> structure of the item triggering the
notification. This field is available only if the <b>TableEventType</b> field
is available and is 0x0003 or 0x0005.</p>

<p><b>InsertAfterTableRowID (8 bytes):</b> The old value
of the <b>Message ID</b> structure of the item triggering the notification.
This field is available only if bit 0x8000 is set in the <b>NotificationFlags</b>
field and if the <b>TableEventType</b> field is available and is 0x0003 or
0x0005.</p>

<p><b>InsertAfterTableRowInstance (4 bytes): </b>An
unsigned 32-bit identifier of the instance of the row where the modified row is
inserted. This field is available only if bit 0x8000 is set in the <b>NotificationFlags</b>
field and if the <b>TableEventType</b> field is available and is 0x0003 or
0x0005.</p>

<p><b>TableRowDataSize (2 bytes):</b> An unsigned 16-bit
integer that indicates the length of the table row data. This field is
available only if the <b>TableEventType</b> field is available and is 0x0003 or
0x0005.</p>

<p><b>TableRowData (variable):</b> The table row data,
which contains a list of property values in a <b>PropertyRow</b> structure, as
specified in [MS-OXCDATA] section <mshelp:link keywords="ca1e5c95-a329-40b5-b50f-911dd3f46d50" tabindex="0">2.8</mshelp:link>,
for the row that was added or modified in the table. The property values to be
included are determined by a previous <b>RopSetColumns</b> ROP, as specified in
<mshelp:link keywords="d33612dc-36a8-4623-8a26-c156cf8aae4b" tabindex="0">[MS-OXCTABL]</mshelp:link>
section <mshelp:link keywords="6aac6d3a-81dd-48b4-9995-46db48ce2242" tabindex="0">2.2.2.2</mshelp:link>.
This field is available only if the <b>TableEventType</b> field is available
and is 0x0003 or 0x0005.</p>

<p><b>FolderId (8 bytes):</b> The <b>Folder ID</b>
structure of the item triggering the event. This field is available only if the
<b>NotificationType</b> value in the <b>NotificationFlags</b> field is not
0x0100 or 0x0400.</p>

<p><b>MessageId (8 bytes):</b> The <b>Message ID</b>
structure, as specified in [MS-OXCDATA] section 2.2.1.2, of the item triggering
the event. This field is available only if the <b>NotificationType</b> value in
the <b>NotificationFlags</b> field is not 0x0100 or 0x0400, and bit 0x8000 is
set in the <b>NotificationFlags</b> field.</p>

<p><b>ParentFolderId (8 bytes):</b> The <b>Folder ID</b>
structure of the parent folder of the item triggering the event. This field is
available only if the value of the <b>NotificationType</b> in the <b>NotificationFlags</b>
field is 0x0004, 0x0008, 0x0020, or 0x0040, and it is sent for either a message
in a search folder (both bit 0x4000 and bit 0x8000 are set in the <b>NotificationFlags</b>
field) or a folder (both bit 0x4000 and bit 0x8000 are not set in the <b>NotificationFlags</b>
field).</p>

<p><b>OldFolderId (8 bytes):</b> The old <b>Folder ID</b>
structure of the item triggering the event. This field is available only if the
<b>NotificationType</b> value in the <b>NotificationFlags</b> field is 0x0020
or 0x0040.</p>

<p><b>OldMessageId (8 bytes):</b> The old <b>Message ID</b>
structure of the item triggering the event. This field is available only if the
value of the <b>NotificationType</b> in the <b>NotificationFlags</b> field is
0x0020 or 0x0040 and bit 0x8000 is set in the <b>NotificationFlags</b> field.</p>

<p><b>OldParentFolderId (8 bytes):</b> The old parent <b>Folder
ID</b> structure of the item triggering the event. This field is available only
if the value of the <b>NotificationType</b> in the <b>NotificationFlags</b>
field is 0x0020 or 0x0040 and bit 0x8000 is not set in the <b>NotificationFlags</b>
field.</p>

<p><b>TagCount (2 bytes):</b> An unsigned 16-bit integer
that specifies the number of property tags in the <b>Tags</b> field. This field
is available only if the value of the <b>NotificationType</b> in the <b>NotificationFlags</b>
field is 0x0004 or 0x0010. If the value of the <b>NotificationType</b> in the <b>NotificationFlags</b>
field is 0x0010, the value of this field SHOULD<a id="Appendix_A_Target_9"></a><a href="e58b7ae4-9c40-46e0-8844-3b9b2aba2d86.htm#Appendix_A_9" aria-label="Product behavior note 9">&lt;9&gt;</a> be set to
0x0000. </p>

<p><b>Tags (variable):</b> An array of unsigned 32-bit
integers that identifies the IDs of properties that have changed. This field is
available only if the <b>TagCount</b> field is available and the value of the <b>TagCount</b>
field is not 0x0000 or 0xFFFF.</p>

<p><b>TotalMessageCount (4 bytes):</b> An unsigned
32-bit integer that specifies the total number of items in the folder
triggering this event. This field is available only if bit 0x1000 is set in the
<b>NotificationFlags</b> field.</p>

<p><b>UnreadMessageCount (4 bytes):</b> An unsigned
32-bit integer that specifies the number of unread items in a folder triggering
this event. This field is available only if bit 0x2000 is set in the <b>NotificationFlags</b>
field.</p>

<p><b>MessageFlags (4 bytes):</b> An unsigned 32-bit
integer that specifies the message flags of new mail that has been received.<a id="Appendix_A_Target_10"></a><a href="e58b7ae4-9c40-46e0-8844-3b9b2aba2d86.htm#Appendix_A_10" aria-label="Product behavior note 10">&lt;10&gt;</a> This field is available only if
the value of the <b>NotificationType</b> in the <b>NotificationFlags</b> field
is 0x0002. For details, see <mshelp:link keywords="7fd7ec40-deec-4c06-9493-1bc06b349682" tabindex="0">[MS-OXCMSG]</mshelp:link>
section <mshelp:link keywords="a0c52fe2-3014-43a7-942d-f43f6f91c366" tabindex="0">2.2.1.6</mshelp:link>.</p>

<p><b>UnicodeFlag (1 byte):</b> A value of <b>TRUE</b>
(0x01) indicates the value of the <b>MessageClass</b> field is in <a href="04fcfcd9-a11c-47cd-aa0c-c10a4085d0c8.htm#gt_c305d0ab-8b94-461a-bd76-13b40cb8c4d8">Unicode</a>; otherwise, <b>FALSE</b>
(0x00) indicates the value of the <b>MessageClass</b> is in <a href="04fcfcd9-a11c-47cd-aa0c-c10a4085d0c8.htm#gt_79fa85ca-ac61-467c-b819-e97dc1a7a599">ASCII</a>. A value of <b>FALSE</b>
is returned if the client is working in cached mode, as specified by the <b>ClientMode</b>
field in <mshelp:link keywords="137f0ce2-31fd-4952-8a7d-6c0b242e4b6a" tabindex="0">[MS-OXCRPC]</mshelp:link>
section <mshelp:link keywords="943e659d-788c-4c09-b07b-651fe4adbf19" tabindex="0">2.2.2.2.4</mshelp:link>.
This field is available only if the value of the <b>NotificationType</b> field
in the <b>NotificationFlags</b> field is 0x0002.</p>

<p><b>MessageClass (variable):</b> A null-terminated
string containing the <a href="04fcfcd9-a11c-47cd-aa0c-c10a4085d0c8.htm#gt_bed860a9-daa0-4ea5-8da6-bf8f3c0b25d8">message
class</a> of the new mail. The string is in Unicode if the <b>UnicodeFlag</b>
field is set to <b>TRUE</b> (0x01). The string is in ASCII if <b>UnicodeFlag</b>
is set to <b>FALSE</b> (0x00). This field is available only if the value of the
<b>NotificationType</b> in the <b>NotificationFlags</b> field is 0x0002. </p>


                </div>
            </div>
        </div>
    </body>
</html>